# Uppgift 1: Databasanvändning

Datan i denna uppgift utgörs av en databas som innehåller uppgifter om cykelturer som gjorts med stadscyklarna år 2024 i Helsingfors och Esbo. Databasen bygger på data som [publicerats av HSL](https://www.avoindata.fi/data/fi/dataset/helsingin-ja-espoon-kaupunkipyorilla-ajatut-matkat) och som har omvandlats till en SQLite-databas för användning i denna kurs. 

Du kan ladda ner databasen här: [bikes_2024.zip](https://cs.helsinki.fi/u/ahslaaks/bikes_2024.zip)

Databasen innehåller följande två tabeller:

```sql
CREATE TABLE Stations (
    id INTEGER PRIMARY KEY,
    name TEXT
);

CREATE TABLE Trips (
    id INTEGER PRIMARY KEY,
    start_time TEXT,
    end_time TEXT,
    start_station_id INTEGER REFERENCES Stations,
    end_station_id INTEGER REFERENCES Stations,
    distance INTEGER,
    duration INTEGER
);
```

I kursmaterialet finns mer detaljerad information om databasens innehåll och exempel på databassökningar.

Din uppgift är att skriva kod som innehåller följande funktioner som använder databasen.

## Deluppgift 1

* Skapa funktionen `trips_from_station(station_name)` som returnerar antalet resor som startat från den angivna stationen.
* Skapa funktionen `trips_to_station(station_name)` som returnerar antalet resor som avslutats vid den angivna stationen.

Funktionerna ska ge som resultat exempelvis att 8535 resor startat från stationen "Intiankatu" och 8448 resor slutat där.

## Deluppgift 2

* Skapa funktionen `longest_distance_trips(limit)` som returnerar de `limit` längsta resornas längd samt deras respektive start- och slutstationer.
* Skapa funktionen `longest_duration_trips(limit)` som returnerar de `limit` längsta resornas varaktighet (tid) samt deras respektive start- och slutstationer.
  
Funktionerna ska ge följande resultat när `limit` är 5:

| Startstation         | Slutstation          | Avstånd (m) |
|--------------------|----------------------|-------------------|
| Erottajan aukio    | Unioninkatu          | 655225            |
| Gunillantie        | Workshop Helsinki    | 425905            |
| Pajamäki           | Paloheinän kirjasto  | 393434            |
| Tupasaarentie      | Marjaniementie       | 277991            |
| Pitäjänmäen asema  | Workshop Helsinki    | 262121            |

| Startstation       | Slutstation      | Varaktighet (s) |
|------------------|------------------|-------------------|
| Lintulahdenkatu  | Marjaniementie   | 6286982           |
| Tupasaarentie    | Marjaniementie   | 4649106           |
| Ehrenströmintie  | Workshop Helsinki| 4396006           |
| Matinkyläntie    | Paciuksenkaari   | 4000567           |
| Kuikkarinne      | Trumpettikuja    | 3987658           |

Sidnot: Dessa uppgifter verkar inte trovärdiga eftersom den avståndsmässigt längsta resan är 655 km och den resa som varade längst är 73 dagar.

## Deluppgift 3

* Skapa funktionen `trips_during_month(month)` som returnerar antalet resor som startat under den angivna månaden. Här motsvarar 1 januari, 2 februari, och så vidare.
* Skapa funktionen `trips_during_weekday(day)` som returnerar antalet resor som startat på den angivna veckodagen. Här motsvarar 1 måndag, 2 tisdag och så vidare.

Funktionerna ska ge följande resultat:

| Månad  | Antal resor |
|-----------|----------------:|
| Huhtikuu  | 167960          |
| Toukokuu  | 448518          |
| Kesäkuu   | 469132          |
| Heinäkuu  | 455422          |
| Elokuu    | 492348          |
| Syyskuu   | 340507          |
| Lokakuu   | 211781          |

| Veckodag      | Antal resor |
|------------|----------------:|
| Maanantai  | 379173          |
| Tiistai    | 423740          |
| Keskiviikko| 405657          |
| Torstai    | 406417          |
| Perjantai  | 367325          |
| Lauantai   | 311952          |
| Sunnuntai  | 291404          |

## Deluppgift 4

* Skapa funktionen `most_popular_start_stations(limit)` som returnerar de `limit` mest populära startstationerna.  
* Skapa funktionen `least_popular_start_stations(limit)`, som returnerar de `limit` minst populära startstationerna.

Funktionerna ska ge följande resultat när `limit` är 5:

| Station                  | Antal avgångar |
|------------------------|----------------|
| Itämerentori           | 50441          |
| Töölönlahdenkatu       | 36382          |
| Rautatientori / länsi  | 32415          |
| Pasilan asema          | 30910          |
| Kalasatama (M)         | 28352          |

| Station                    | Antal avgångar |
|--------------------------|----------------|
| Relay Box test station   | 9              |
| Workshop Helsinki        | 26             |
| Puistolan VPK            | 393            |
| Sateenkaarentie          | 418            |
| Jakomäentie              | 481            |

Här verkar "Relay Box test station" vara en teststation och "Workshop Helsinki" ett cykelgarage. Den minst populära startstationen verkar således vara "Puistolan VPK". 

## Deluppgift 5

* Skapa funktionen `largest_differences(limit)` som returnerar de `limit` största skillnaderna mellan antalet resor som startat och antalet resor som avslutats vid en station.

Funktionen ska ge följande resultat när `limit` är 5:

| Station                 | Antal startade resor| Antal avslutade resor | Skillnad |
|-------------------------|------:|--------:|--------:|
| Pasilan asema           | 30910 |   26670 |    4240 |
| Karhupuisto             |  9686 |    8018 |    1668 |
| Sompasaari              | 21604 |   23158 |    1554 |
| Vallilan varikko        |  6068 |    4647 |    1421 |
| Opastinsilta            |  5905 |    4550 |    1355 |

## Inlämning

PDF-rapporten ska innehålla kod med ovanstående funktioner samt exempel då koderna används och ger de efterfrågade resultaten.
